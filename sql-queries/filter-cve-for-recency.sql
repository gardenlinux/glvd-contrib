SELECT
    deb_cve.*
FROM
    all_cve
    INNER JOIN deb_cve USING (cve_id)
    INNER JOIN dist_cpe ON (deb_cve.dist_id = dist_cpe.id)
WHERE
    dist_cpe.cpe_vendor = 'debian'
    AND dist_cpe.cpe_product = 'debian_linux'
    AND dist_cpe.deb_codename = 'trixie'
    -- Filter for recent CVEs, i.e. those who's year is the current year or the year before that.
    -- This filter might be useful because many old CVEs linger around in the database
    -- that technically are vulnerable, but no one seems to care enough about them.
    -- This assumes the start of the cve_id column is always in the format CVE-YYYY, which should always be the case
    AND SUBSTRING(deb_cve.cve_id, 5, 4)::INTEGER >= EXTRACT(YEAR FROM NOW()) - 1
